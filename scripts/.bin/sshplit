#!/usr/bin/env bash
set -euo pipefail

HOSTS=${HOSTS:=$*}

if [ -z "$HOSTS" ]; then
  echo -n "Please provide of list of hosts separated by spaces [ENTER]: "
  read -r HOSTS
fi

hosts=( $HOSTS )

# FIXME: shouldn't hard code the user
tmux new-window "sshrc core@${hosts[0]}"

unset "hosts[0]"

for i in "${hosts[@]}"; do
  tmux split-window -h  "sshrc core@$i"
  tmux select-layout tiled > /dev/null
done

tmux select-pane -t 0
tmux set-window-option synchronize-panes on > /dev/null
